<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Quran Verses</title>
      <style>

         .verse-container {
         display: flex;
         justify-content: space-between;
         }
         .arabic-text {
         font-size: 1em;
         line-height: 2.2em;
         margin: 0;
         padding: 0;
         direction: rtl;
         text-align: right;
         }
         .english-text {
         font-size: 1em;
         line-height: 2.2em;
         margin: 0;
         padding: 0;
         }
         body {
         display: flex;
         flex-direction: column;
         align-items: center;
         justify-content: center;
         height: 100vh;
         margin: 0;
         font-family: Arial, sans-serif;
         background-color: #093F2D;
         color: white;
         align-items: center;
         }
         h1 {
         margin-bottom: 10px;
         align-items: center;
         }
         #surahContainer {
         height: 300px;
         overflow-y: scroll;
         border: 1px solid #ccc;
         padding: 10px;
         width: 90%;
         }
         .highlighted {
         background-color: #92F4D3;
         color: black;
         }
         .surahs {
         display: none;
         flex-direction: row;
         justify-content: center; /* Add this line */
         width: 100%; /* Add this line */
         }
         .fetched-verse {
        display: flex;
        justify-content: center;
        align-items: center;
         text-align: center;
}
      </style>
   </head>
   <body>
      <h1>القرآن الكريم (The Honorable Quran.)</h1>
      <br>
      <input type="text" id="topic" placeholder="Enter a topic">
      <br>
      <button onclick="fetchVerseByTopic()">Search Topic</button>
      <br>
      <button onclick="revealSurah()">Reveal</button>
      <div class='fetched-verse'>
        <p id="verse"></p>
      </div>
      <div class="surahs">
    <div id="surahContainer">
    </div>
</div>
      <script>
         let currentSurah = null;
         let currentAyah = null;
         
         async function fetchVerseByTopic() {
             const topic = document.getElementById("topic").value.trim();
         
             if (topic === "") {
                 alert("Please enter a topic.");
                 return;
             }
         
             const response = await fetch(`https://api.quran.com/api/v4/search?q=${topic}&size=1&page=${Math.floor(Math.random() * 10) + 1}`);
             const searchData = await response.json();
         
             if (searchData.search.total_results === 0) {
                 alert("No verses found for this topic.");
                 return;
             }
         
             const randomIndex = Math.floor(Math.random() * searchData.search.results.length);
             const verse = searchData.search.results[randomIndex];
             const verseId = verse.verse_id;
         
             const responseVerse = await fetch(`https://api.alquran.cloud/v1/ayah/${verseId}/editions/quran-simple,en.sahih`);
             const verseData = await responseVerse.json();
         
             const arabicText = verseData.data[0].text;
             const englishText = verseData.data[1].text;
             currentSurah = verseData.data[1].surah.number;
             currentAyah = verseData.data[1].numberInSurah;
         
             document.getElementById("verse").innerHTML = `${arabicText}<br>${englishText}`;
         }
         
         async function revealSurah() {
  if (!currentSurah) {
    alert("Please fetch a verse by topic first.");
    return;
  }

  const responseSurah = await fetch(`https://api.alquran.cloud/v1/surah/${currentSurah}/editions/quran-simple,en.sahih`);
  const surahData = await responseSurah.json();

  let surahContent = '';

  surahData.data[1].ayahs.forEach((ayah, index) => {
    const ayahNumber = ayah.numberInSurah;
    const ayahText = ayah.text;
    const highlighted = ayahNumber === currentAyah ? 'highlighted' : '';

    let ayahTextArabic = surahData.data[0].ayahs[index].text;
    if (index === 0 && currentSurah !== 1 && currentSurah !== 9) {
        ayahTextArabic = ayahTextArabic.replace(/^بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ\s*/, '');
    }
    surahContent += `<div class="verse-container"><p class="${highlighted} english-text">${ayahNumber}. ${ayahText}</p><p class="${highlighted} arabic-text">${ayahTextArabic}</p></div>`;
  });

  if (currentSurah !== 1 && currentSurah !== 9) {
    surahContent = `<div class="verse-container"><p class="english-text">0. In the name of Allah, the Entirely Merciful, the Especially Merciful.</p><p class="arabic-text">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</p></div>${surahContent}`;
  }

  document.getElementById('surahContainer').innerHTML = surahContent;

  document.querySelector('.surahs').style.display = 'flex';

  const highlightedElement = document.querySelector('.highlighted');
  const surahContainer = document.getElementById('surahContainer');

  const contentHeight = surahContainer.scrollHeight;
  const containerHeight = surahContainer.offsetHeight;
  const elementOffsetTop = highlightedElement.offsetTop;
  const elementHeight = highlightedElement.offsetHeight;

  const scrollTopValue = Math.min(elementOffsetTop - (containerHeight - elementHeight) / 2, contentHeight - containerHeight);
  surahContainer.scrollTop = scrollTopValue;
}

         
      </script>
   </body>
</html>